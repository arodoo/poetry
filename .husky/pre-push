#!/usr/bin/env sh
# File: .husky/pre-push
# Purpose: Run heavy validation tasks (typecheck, tests, builds) after commit message validation.
# All Rights Reserved. Arodi Emmanuel

echo "ğŸš€ Pre-push heavy checks starting..."

echo "âš¡ Type checking..."
npm run typecheck || {
	echo "âŒ Type check failed! Check the output above for specific type errors in files."
	exit 1
}

echo "ğŸ§ª Running frontend tests..."
npm run test:frontend || {
	echo "âŒ Frontend tests failed! Check the output above for specific test failures."
	exit 1
}

echo "ğŸ§ª Running backend tests..."
npm run test:backend || {
	echo "âŒ Backend tests failed! Check the output above for specific test failures."
	exit 1
}

echo "ğŸ—ï¸ Building frontend..."
npm --prefix poetry-frontend run build || {
	echo "âŒ Frontend build failed! Check the output above for build errors."
	exit 1
}

echo "ğŸ—ï¸ Building backend..."
(cd poetry-backend && mvn -q -DskipTests package) || {
	echo "âŒ Backend build failed! Check the output above for compilation errors."
	exit 1
}

echo "âœ… All pre-push heavy checks passed!"
