<!--
File: 12.0.3-backend-i18n-problem-factory-and-error-codes.md
Purpose: Introduces error code enumeration and ProblemDetail factory that
localizes titles and details using message bundles while preserving stable
machine-readable codes. Establishes unified construction path for all
problem responses across auth and global handlers. All Rights Reserved.
Arodi Emmanuel
-->

# Task 12.0.3: Backend i18n â€“ Problem Factory & Error Codes

## Objective

Create a centralized mechanism to build RFC7807 ProblemDetail objects using
stable error codes + localized messages (title/detail) plus i18n metadata.

## Scope

- ErrorCode interface (code, titleKey, detailKey).
- AuthErrorCode enum implementing ErrorCode for current auth errors.
- PlatformErrorCode enum for generic/unexpected/validation wrappers.
- ProblemBuilder (interface) + DefaultProblemBuilder implementation.
- Refactor existing \*ProblemHandler classes to delegate to builder.
- Maintain existing HTTP statuses and codes (additive response fields only).

## Out of Scope

- Validation field-level code mapping (12.0.4).
- OpenAPI spec update (12.0.4).
- Logging adjustments (12.0.5).

## Problem Structure (Target)

```
{
  "type":"https://datatracker.ietf.org/doc/html/rfc7807",
  "status":401,
  "title":"Invalid credentials",
  "detail":"Username or password is incorrect.",
  "code":"auth.invalid_credentials",
  "i18n":{
    "titleKey":"auth.invalid_credentials.title",
    "detailKey":"auth.invalid_credentials.detail",
    "args":[]
  }
}
```

## Design Points

- Builder resolves Locale from LocaleContextHolder internally.
- Adds i18n metadata map via `setProperty` for keys + args.
- Falls back gracefully if a key is missing (title/detail become code).
- Handlers become thin: map exception -> enum constant + status.
- Keeps lines <80 by splitting enums if growth occurs (one enum per domain).

## Steps

1. Define ErrorCode interface.
2. Implement AuthErrorCode + PlatformErrorCode.
3. Implement ProblemBuilder + DefaultProblemBuilder (uses MessageSource).
4. Refactor AuthProblemHandler & GlobalProblemHandler to use builder.
5. Add unit test placeholder note (tests remain English, later task).
6. Update docs (this file Actual Result upon completion).

## Acceptance Criteria

- All handlers now call builder; no hardcoded human strings remain.
- ProblemDetail responses include code + i18n metadata.
- Missing keys degrade to code string, not nulls.

## Expected Result

Unified localized problem construction ready for validation integration.

## Actual Result

Pending.
