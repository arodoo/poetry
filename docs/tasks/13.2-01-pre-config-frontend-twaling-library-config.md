/_ File: 13.2-pre-config-frontend-twaling-library-config.md Purpose:
Intermediate task to prepare the frontend environment for the Tailwind UI tokens
library and admin-only configuration page before full migration (Task 13.2).
This pre-config focuses on routes, guards, SDK integration, minimal tokens
feature scaffolding, i18n, and acceptance gates. All Rights Reserved. _/

# 13.2 (Pre-Config) Frontend Tailwind UI Library Prep

Goal: Stand up the minimal scaffolding needed to integrate backend tokens
(`GET /api/v1/tokens`) and expose an admin-only protected page to visualize
readiness. No visual design yet—just wiring, contracts, and guards. This
unblocks the full migration in `13.2-frontend-twaling-library-config.md`.

Scope (pre-config only)

- Admin-only route (locale-prefixed) and guard in place.
- Provisional SDK method `getTokens()` with ETag-ready header plumbing.
- Tokens feature skeleton: Zod schema, API wrapper, TanStack Query hook.
- i18n keys (no hardcoded text) for admin/tokens page and navigation.
- No component styling, no business logic—purely structural.

Assumptions

- Backend endpoints verified as per 13.2 notes: `GET /api/v1/tokens` with
  `ETag`.
- Auth is present; session exposes a `roles` array including `admin` when
  applicable.
- Locale routing is `/:locale/...` (as per chatmode rules) and route strings
  come from i18n.

Deliverables

1. SDK: `getTokens()` + types (slice) and headers support (If-None-Match
   placeholder).
2. Feature: `src/features/tokens/{model,api,hooks}` with zod parsing & query
   key.
3. Guard: `RequireRole` (admin) composable for route elements.
4. Route: `/:locale/admin/tokens` page stub gated by `RequireRole('admin')`.
5. i18n: `ui.admin.tokens.*` keys in `en` and `es` catalogs.

Acceptance Criteria

- Visiting `/:locale/admin/tokens` without admin role -> redirected to
  `/:locale/unauthorized` (or basic message placeholder if route not yet
  present).
- With admin role -> page renders and triggers `getTokens()` query (result
  logged to console or shown as JSON pre tag for now).
- No hardcoded text; all visible strings pulled from i18n.
- Lint/typecheck pass; files respect ~80-line guideline via splits.

Next Step (after pre-config)

- Hydrate Tailwind runtime variables from token payload, create TokensProvider,
  wire theme switching, and add tests per 13.2 main task.

## Actual Result (2025-09-09)

Pre-configuration scaffolding delivered:

- Admin guard `RequireRole` with unit tests (allow + deny) ensuring redirect to
  unauthorized route.
- Route registry extended (`adminTokens`, `unauthorized`); BrowserRouter wired
  in `App.tsx` with guarded admin tokens page.
- Unauthorized page implemented and localized.
- Tokens feature: Zod schemas, API wrapper (ETag conditional fetch), React Query
  hook, provider applying CSS vars, and comprehensive tests (schema, API, hook,
  provider).
- Manual SDK abstraction encapsulates fetch; no direct fetch in UI layer per
  architecture rules.
- i18n catalogs (en/es) updated with admin tokens and unauthorized keys; key
  coverage tests green.
- Initial UI primitives (Button, Alert, Text) validate Tailwind + tokens
  integration; each with concise tests.
- All new files respect <80 line rule (tests <40 lines); TypeScript strict with
  descriptive identifiers.
- Full test suite passing (31 tests) and lint clean.

Out of scope for pre-config (deferred to main Task 13.2): full legacy component
migration, complete a11y audits, dynamic token group switching UI, additional
token groups (fonts, sizes, spacings, radii, shadows) full runtime application,
and extended domain documentation updates.
